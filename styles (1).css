:root{
  --bg:#f6f1e6; --paper:#fffdf7; --ink:#232323; --muted:#6b7280; --line:#e6dccb;
  --roman-red:#7a1f1f; --roman-gold:#b8860b; --accent:#7a3b00;
  --trade-color:#2563eb; --military-color:#dc2626; --settlement-color:#16a34a;
}
*{box-sizing:border-box;transition:all .16s ease}
body{
  margin:0;font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial;color:var(--ink);
  background:
    radial-gradient(rgba(184,134,11,.06) 1px, transparent 1px) 0 0/22px 22px,
    radial-gradient(rgba(122,31,31,.05) 1px, transparent 1px) 11px 11px/44px 44px,
    linear-gradient(180deg,#fbf8f1,var(--bg));
}
.container{max-width:1400px;margin:0 auto;padding:22px}
.card{background:var(--paper);border:1px solid var(--line);border-radius:22px;padding:16px;box-shadow:0 6px 18px rgba(0,0,0,.06);margin-bottom:12px}
.header{display:flex;gap:12px;align-items:center;background:linear-gradient(180deg,#fff8ef,#fcf7ea);border:1px solid var(--line);padding:10px 14px;border-radius:22px;outline:3px double var(--roman-gold)}
h1{font-size:26px;margin:0;font-weight:900;color:var(--roman-red)}
h2{font-size:20px;margin:12px 0 8px}
h3{font-size:16px;margin:8px 0 6px;font-weight:800}
.subtitle{font-size:13px;color:#555}
.grid{display:grid;gap:10px}
.g2{grid-template-columns:1fr 1fr}
.g3{grid-template-columns:repeat(3,1fr)}
.g4{grid-template-columns:repeat(4,1fr)}
.g5{grid-template-columns:repeat(5,1fr)}
.pill{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;font-size:13px;font-weight:700;border:1px solid var(--line);background:#fff}
.choice{border:1px solid var(--line);border-radius:14px;background:#fff;padding:12px;cursor:pointer}
.choice:hover{background:#fff9f3;box-shadow:0 2px 8px rgba(0,0,0,.08);transform:translateY(-1px)}
.choice.selected{outline:2px solid var(--roman-gold)}
.small{font-size:12px;color:#6b7280}
.tiny{font-size:11px;color:#9ca3af}
.tag{display:inline-block;font-size:12px;padding:4px 8px;border-radius:999px;border:1px solid var(--line);background:#fff}
.divider{height:1px;background:linear-gradient(90deg,transparent,var(--line),transparent);margin:12px 0}
.btn{appearance:none;border:1px solid var(--line);background:#fff;color:#111;padding:10px 14px;border-radius:12px;font-weight:800;cursor:pointer;font-size:14px}
.btn:hover:not(:disabled){background:#faf2e6;transform:translateY(-1px)}
.btn:disabled{opacity:0.5;cursor:not-allowed}
.btn-primary{background:var(--roman-red);color:#fff;border-color:#5e1818;box-shadow:0 2px 0 #5e1818}
.btn-primary:hover:not(:disabled){background:#8e2a2a}
.btn-success{background:var(--settlement-color);color:#fff;border-color:#15803d}
.btn-success:hover:not(:disabled){background:#166534}
.statbar{height:10px;border-radius:6px;background:#eee;overflow:hidden;position:relative}
.bar{height:100%;transition:width 0.3s ease}
.tabs{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:8px}
.tab{padding:8px 12px;border:1px solid var(--line);border-radius:999px;background:#fff;cursor:pointer;font-weight:800;font-size:13px}
.tab.active{background:#fff0e6;border-color:#e6cfa8}
.info{background:#eff6ff;border:1px solid #bfdbfe;padding:8px 12px;border-radius:8px;margin:8px 0;font-size:13px}
.success{color:#16a34a;font-weight:700}
.warning{color:#dc2626;font-weight:700}
.milestone{background:linear-gradient(135deg,#fef3c7,#fde68a);border:2px solid var(--roman-gold);padding:10px;border-radius:12px;margin:8px 0;font-weight:700}
.map-container{background:#f9fafb;border:2px solid var(--line);border-radius:12px;padding:16px;margin:12px 0}
.map-grid{display:flex;flex-wrap:wrap;gap:12px;margin-top:12px;justify-content:center;align-items:flex-start}
.territory{
  position:relative;width:140px;height:160px;
  clip-path:polygon(30% 0%, 70% 0%, 100% 30%, 100% 70%, 70% 100%, 30% 100%, 0% 70%, 0% 30%);
  border:3px solid #d1d5db;padding:16px 8px;text-align:center;cursor:pointer;
  display:flex;flex-direction:column;justify-content:center;align-items:center;
  transition:all 0.2s ease;
}
.territory:hover:not(.locked){transform:scale(1.05);box-shadow:0 8px 16px rgba(0,0,0,0.15)}
.territory.owned{background:linear-gradient(135deg,#dcfce7,#bbf7d0);border-color:#16a34a;box-shadow:0 0 12px rgba(22,163,74,0.3)}
.territory.contested{background:linear-gradient(135deg,#fef3c7,#fde68a);border-color:#ca8a04;box-shadow:0 0 12px rgba(202,138,4,0.3)}
.territory.hostile{background:linear-gradient(135deg,#fee2e2,#fecaca);border-color:#dc2626;box-shadow:0 0 12px rgba(220,38,38,0.3)}
.territory.hostile-hard{background:linear-gradient(135deg,#450a0a,#7f1d1d);color:#fff;border-color:#991b1b;box-shadow:0 0 16px rgba(153,27,27,0.5)}
.territory.locked{opacity:0.4;cursor:not-allowed;filter:grayscale(0.8)}
.map-tabs{display:flex;gap:8px;margin-bottom:12px;flex-wrap:wrap}
.rarity{display:inline-block;font-size:11px;font-weight:900;padding:2px 6px;border-radius:4px;margin-left:4px;text-transform:uppercase;letter-spacing:0.5px}
.rarity-common{color:#6b7280;border:1px solid #d1d5db}
.rarity-uncommon{color:#16a34a;border:1px solid #86efac;background:rgba(22,163,74,0.05)}
.rarity-rare{color:#2563eb;border:1px solid #60a5fa;background:rgba(37,99,235,0.05)}
.rarity-epic{color:#9333ea;border:1px solid #c084fc;background:rgba(147,51,234,0.05)}
.rarity-legendary{color:#ea580c;border:1px solid #fb923c;background:rgba(234,88,12,0.05)}
.rarity-imperial{color:#dc2626;border:1px solid #fca5a5;background:linear-gradient(90deg,rgba(220,38,38,0.1),rgba(234,88,12,0.1),rgba(234,179,8,0.1));font-weight:900;animation:imperial-glow 2s ease-in-out infinite}
@keyframes imperial-glow{0%,100%{text-shadow:0 0 4px rgba(220,38,38,0.5)}50%{text-shadow:0 0 8px rgba(220,38,38,0.8),0 0 12px rgba(234,88,12,0.5)}}
.save-load-btn{position:fixed;top:20px;right:20px;z-index:1000;display:flex;gap:8px;flex-direction:column}
.battle-screen{position:fixed;inset:0;background:rgba(0,0,0,0.95);z-index:9999;display:flex;align-items:center;justify-content:center;animation:fadeIn 0.3s}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
.battle-card{background:var(--paper);border:3px solid var(--roman-red);border-radius:16px;padding:24px;max-width:600px;width:90%;box-shadow:0 20px 60px rgba(0,0,0,0.5)}
.battle-animation{width:100%;height:200px;background:linear-gradient(180deg,#fee2e2,#fef3c7);border-radius:12px;margin:16px 0;position:relative;overflow:hidden;border:2px solid var(--line)}
.battle-unit{position:absolute;width:40px;height:40px;font-size:32px;animation:battle-move 2s ease-in-out infinite}
.unit-left{left:20%;top:50%;transform:translateY(-50%);animation:battle-attack-left 2s ease-in-out infinite}
.unit-right{right:20%;top:50%;transform:translateY(-50%);animation:battle-attack-right 2s ease-in-out infinite}
@keyframes battle-attack-left{0%,100%{transform:translateY(-50%) translateX(0)}25%{transform:translateY(-50%) translateX(20px) scale(1.1)}50%{transform:translateY(-50%) translateX(0)}}
@keyframes battle-attack-right{0%,100%{transform:translateY(-50%) translateX(0)}25%{transform:translateY(-50%) translateX(-20px) scale(1.1)}50%{transform:translateY(-50%) translateX(0)}}
.battle-effects{position:absolute;inset:0;pointer-events:none}
.battle-spark{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:24px;animation:spark 1s ease-out infinite}
@keyframes spark{0%{opacity:1;transform:translate(-50%,-50%) scale(0.5)}50%{opacity:0.8;transform:translate(-50%,-50%) scale(1.2)}100%{opacity:0;transform:translate(-50%,-50%) scale(2)}}
.win-chance{font-size:28px;font-weight:900;text-align:center;margin:12px 0;padding:12px;border-radius:8px}
.win-high{background:linear-gradient(135deg,#dcfce7,#bbf7d0);color:#15803d}
.win-medium{background:linear-gradient(135deg,#fef3c7,#fde68a);color:#b45309}
.win-low{background:linear-gradient(135deg,#fee2e2,#fecaca);color:#991b1b}
.snake-game{position:fixed;inset:0;background:rgba(0,0,0,0.95);z-index:9999;display:flex;align-items:center;justify-content:center;flex-direction:column}
.snake-canvas{border:4px solid var(--roman-gold);background:#1a1a1a;box-shadow:0 20px 60px rgba(0,0,0,0.8)}
.snake-score{color:#fff;font-size:24px;font-weight:900;margin-bottom:16px;text-shadow:0 2px 4px rgba(0,0,0,0.5)}
.snake-controls{color:#aaa;font-size:14px;margin-top:16px;text-align:center}
.territory img{width:100%;height:80px;object-fit:cover;border-radius:6px;margin-bottom:8px}
.resource-production{display:flex;gap:12px;flex-wrap:wrap;margin:8px 0}
.production-item{background:#fff;border:1px solid var(--line);padding:8px 12px;border-radius:8px;display:flex;align-items:center;gap:8px}

/* NEW FEATURES STYLING */
.advisor{position:fixed;bottom:20px;right:20px;max-width:300px;background:linear-gradient(135deg,#fef3c7,#fde68a);border:2px solid var(--roman-gold);border-radius:12px;padding:12px 16px;box-shadow:0 8px 24px rgba(0,0,0,0.15);z-index:999;animation:slideInRight 0.3s ease}
.advisor-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.advisor-title{font-weight:900;font-size:14px;color:var(--roman-red)}
.advisor-close{cursor:pointer;font-size:18px;line-height:1;color:#666;font-weight:900}
.advisor-close:hover{color:var(--roman-red)}
.advisor-text{font-size:13px;line-height:1.4;color:#333}
@keyframes slideInRight{from{transform:translateX(400px);opacity:0}to{transform:translateX(0);opacity:1}}

.achievement-notification{position:fixed;top:80px;right:20px;max-width:320px;background:linear-gradient(135deg,#dcfce7,#bbf7d0);border:2px solid #16a34a;border-radius:12px;padding:14px 18px;box-shadow:0 8px 24px rgba(0,0,0,0.2);z-index:1001;animation:achievementPop 0.5s ease}
.achievement-notification .achievement-icon{font-size:32px;margin-bottom:6px}
.achievement-notification .achievement-title{font-weight:900;font-size:16px;color:#15803d;margin-bottom:4px}
.achievement-notification .achievement-desc{font-size:12px;color:#166534;margin-bottom:6px}
.achievement-notification .achievement-reward{font-size:11px;color:#15803d;font-weight:700}
@keyframes achievementPop{0%{transform:translateX(400px) scale(0.8);opacity:0}60%{transform:translateX(-10px) scale(1.05)}100%{transform:translateX(0) scale(1);opacity:1}}

.pulse{animation:pulse 1.5s ease-in-out infinite}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}

.coin-gain{animation:coinGain 0.6s ease}
@keyframes coinGain{0%{transform:translateY(0);opacity:1}100%{transform:translateY(-20px);opacity:0}}

.progress-bar-container{background:#eee;height:8px;border-radius:4px;overflow:hidden;margin:6px 0}
.progress-bar-fill{height:100%;background:linear-gradient(90deg,#16a34a,#22c55e);transition:width 0.3s ease;border-radius:4px}

.tooltip{position:relative;display:inline-block}
.tooltip .tooltiptext{visibility:hidden;width:200px;background-color:#333;color:#fff;text-align:center;border-radius:6px;padding:8px;position:absolute;z-index:1000;bottom:125%;left:50%;margin-left:-100px;opacity:0;transition:opacity 0.3s;font-size:12px;line-height:1.4}
.tooltip:hover .tooltiptext{visibility:visible;opacity:0.95}
.tooltip .tooltiptext::after{content:"";position:absolute;top:100%;left:50%;margin-left:-5px;border-width:5px;border-style:solid;border-color:#333 transparent transparent transparent}

.achievement-badge{display:inline-flex;align-items:center;gap:6px;padding:6px 12px;border-radius:999px;background:linear-gradient(135deg,#fef3c7,#fde68a);border:2px solid var(--roman-gold);font-size:12px;font-weight:800;margin:4px;box-shadow:0 2px 6px rgba(0,0,0,0.1)}
.achievement-badge.locked{opacity:0.4;background:#f3f4f6;border-color:#d1d5db}

.quest-card{background:linear-gradient(135deg,#eff6ff,#dbeafe);border:2px solid #3b82f6;border-radius:12px;padding:12px;margin:8px 0}
.quest-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.quest-title{font-weight:900;font-size:14px;color:#1e40af}
.quest-progress{font-size:12px;color:#3b82f6;font-weight:700}
.quest-desc{font-size:12px;color:#1e3a8a;margin-bottom:6px}
.quest-reward{font-size:11px;color:#1e40af;font-weight:700;background:rgba(59,130,246,0.1);padding:4px 8px;border-radius:6px;display:inline-block}

.combo-card{background:#fff;border:2px solid var(--line);border-radius:12px;padding:12px;margin:8px 0;transition:all 0.2s}
.combo-card:hover{border-color:var(--roman-gold);box-shadow:0 4px 12px rgba(0,0,0,0.1);transform:translateY(-2px)}
.combo-cost{display:flex;gap:8px;margin:8px 0;flex-wrap:wrap}
.combo-cost-item{background:#f3f4f6;padding:4px 8px;border-radius:6px;font-size:12px;font-weight:700}

.season-indicator{display:inline-flex;align-items:center;gap:6px;padding:6px 12px;border-radius:999px;background:rgba(255,255,255,0.9);border:2px solid var(--line);font-size:13px;font-weight:800}

.building-level{display:inline-flex;align-items:center;gap:2px;margin-left:6px}
.building-level .star{color:var(--roman-gold);font-size:14px}

.specialization-badge{display:inline-block;padding:3px 8px;border-radius:999px;font-size:11px;font-weight:800;margin-left:6px}
.spec-military{background:rgba(220,38,38,0.1);color:#dc2626;border:1px solid #fca5a5}
.spec-trade{background:rgba(37,99,235,0.1);color:#2563eb;border:1px solid #93c5fd}
.spec-farm{background:rgba(22,163,74,0.1);color:#16a34a;border:1px solid #86efac}
.spec-mine{background:rgba(120,53,15,0.1);color:#78350f;border:1px solid #d97706}

.stat-change{display:inline-block;margin-left:6px;font-size:12px;font-weight:700;animation:statChange 0.5s ease}
.stat-change.positive{color:#16a34a}
.stat-change.negative{color:#dc2626}
@keyframes statChange{0%{transform:scale(0.8);opacity:0}50%{transform:scale(1.2)}100%{transform:scale(1);opacity:1}}

@media(max-width:768px){
  .g3,.g4,.g5{grid-template-columns:1fr}
  .map-grid{gap:8px}
  .territory{width:120px;height:140px;font-size:11px}
  .advisor{max-width:260px;bottom:10px;right:10px}
  .achievement-notification{max-width:280px;top:60px;right:10px}
}

/* === DEV DEBUG PANEL === */
#devDebugToggle{position:fixed;bottom:24px;left:24px;z-index:99999;border:2px solid #111;
background:#fff;padding:10px 12px;border-radius:12px;font-weight:900;cursor:pointer;box-shadow:0 6px 18px rgba(0,0,0,.18)}
#devDebugToggle:hover{transform:translateY(-1px)}
#devDebugPanel{position:fixed;bottom:80px;left:24px;z-index:99998;width:360px;max-height:70vh;overflow:auto;
background:#0b1020;color:#e6f0ff;border:2px solid #4b5563;border-radius:14px;box-shadow:0 18px 48px rgba(0,0,0,.4);display:none}
#devDebugPanel header{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-bottom:1px solid #374151}
#devDebugPanel header h3{margin:0;font-size:14px;letter-spacing:.5px}
#devDebugPanel .tabbar{display:flex;gap:6px;padding:8px 10px;border-bottom:1px solid #374151}
#devDebugPanel .tabbar button{flex:1;padding:8px 10px;border:1px solid #374151;background:#111827;color:#e5e7eb;border-radius:8px;cursor:pointer;font-weight:700}
#devDebugPanel .tabbar button.active{background:#1f2937}
#devDebugPanel .body{padding:10px 12px}
#devDebugPanel .body pre{background:#111827;border:1px solid #374151;color:#e5e7eb;border-radius:8px;padding:8px;white-space:pre-wrap;word-break:break-word}
#devDebugPanel .grid{display:grid;grid-template-columns:1fr 1fr;gap:8px}
#devDebugPanel .grid button{padding:8px;border:1px solid #374151;background:#0f172a;color:#e5e7eb;border-radius:8px;cursor:pointer;font-weight:800}
#devDebugPanel .grid button:hover{background:#1f2937}
#devDebugPanel textarea{width:100%;min-height:120px;background:#111827;color:#e5e7eb;border:1px solid #374151;border-radius:8px;padding:8px}


/* === MODS tab styling === */
#devDebugPanel .mods-list{display:flex;flex-direction:column;gap:8px;margin-top:8px}
#devDebugPanel .mod-item{display:flex;justify-content:space-between;align-items:center;background:#111827;border:1px solid #374151;border-radius:8px;padding:8px}
#devDebugPanel .mod-item .meta{font-size:12px;color:#9ca3af}
#devDebugPanel .row{display:flex;gap:8px;flex-wrap:wrap;margin:8px 0}
#devDebugPanel input[type="file"]{border:1px solid #374151;background:#0f172a;color:#e5e7eb;border-radius:8px;padding:6px}

/* === Performance & Reduced Motion improvements === */
@media (prefers-reduced-motion: reduce) {
* {
  animation-duration: 0.001ms !important;
  animation-iteration-count: 1 !important;
  transition-duration: 0.001ms !important;
  scroll-behavior: auto !important;
}
}

/* Avoid expensive transitions on everything */
* { transition: none !important; }
/* Whitelist common interactive elements */
.choice, .territory, .btn, button, [role="button"] {
transition: transform .16s ease, box-shadow .16s ease, opacity .16s ease !important;
}
/* Hide legacy Save/Load/Delete controls */
#save-btn, #load-btn, #delete-btn,
.save-load-btn,
button[data-action="save"], button[data-action="load"], button[data-action="delete"],
[role="button"][data-action="save"], [role="button"][data-action="load"], [role="button"][data-action="delete"] {
display: none !important;
}
/* Ensure no duplicate tabs appear if other code re-inserts them */
.tabs .tab[data-focus="military"]:nth-of-type(n+2),
.tabs .tab[data-focus="tracker"]:nth-of-type(n+2) { display: none !important; }
